name: Docker
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
     
    - name: Build Docker image
      run: docker build -t jmeter-test.
    - name: Run JMeter test
      run: docker run --rm jmeter-test -n -t SampleAPITest_2mins.jmx -l result.jtl -j jmeter.log
    - name: Upload JMeter results
      uses: actions/upload-artifact@v2
      with:
        name: jmeter-results
        path: results

